<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>CafeGo</title>
    <link rel="icon" href="/favicon.ico"/>
    <link rel="stylesheet" href="/css/cafego.css"/>

    <script>
        async function handleLogout(event) {
            event.preventDefault(); // 폼 제출 방지

            try {
                const response = await fetch('/api/auth/logout', {
                    method: 'POST'
                });

                if (response.ok) {
                    alert('로그아웃되었습니다.');
                    window.location.href = '/'; // 홈으로 이동
                    // 또는 window.location.reload(); // 현재 페이지 새로고침
                } else {
                    alert('로그아웃 실패');
                }
            } catch (error) {
                console.error(error);
                alert('네트워크 오류');
            }
        }
    </script>
</head>
<body>

<nav class="cg-nav">
    <div class="cg-container cg-nav__inner">
        <a href="/" class="cg-brand" aria-label="CafeGo">CafeGo</a>

        <ul class="cg-navlinks">
            <li><a href="/index/cafes">탐색</a></li>
            <li><a href="/index/map">지도</a></li>
        </ul>

        <div class="cg-nav__actions">
            {{^isLoggedIn}}
                <a href="/signup" class="cg-btn-outline">회원가입</a>
                <a href="/login"  class="cg-btn-outline">로그인</a>
            {{/isLoggedIn}}

            {{#isLoggedIn}}
                안녕하세요,<span class="cg-me-email">{{currentUserNickname}}</span>님!
                <form id="logoutForm" action="/api/auth/logout" method="post" onsubmit="handleLogout(event)">
                    <button class="cg-btn-outline" type="submit">로그아웃</button>
                </form>
            {{/isLoggedIn}}
        </div>
    </div>
</nav>

</body>
</html>