{{>layout/header}}

<main class="cg-container mypage" style="padding:24px 0">
    <h1 class="cg-title">내 정보 수정</h1>

    <div id="me-layout" style="display:grid;grid-template-columns:220px 1fr;column-gap:24px;align-items:start;">
        <aside>
            <nav>
                <a href="/member/edit"      style="display:block;padding:12px 14px;margin-bottom:8px;border:1px solid #e5e7eb;border-radius:12px;text-decoration:none;">내 정보 수정</a>
                <a href="/reviews/mine"     style="display:block;padding:12px 14px;margin-bottom:8px;border:1px solid #e5e7eb;border-radius:12px;text-decoration:none;">내가 쓴 리뷰</a>
                <a href="/favorites"        style="display:block;padding:12px 14px;margin-bottom:8px;border:1px solid #e5e7eb;border-radius:12px;text-decoration:none;">즐겨찾기 목록 확인</a>
                <a href="/member/withdraw"  style="display:block;padding:12px 14px;margin-bottom:8px;border:1px solid #fecaca;border-radius:12px;background:#fff7f7;color:#dc2626;text-decoration:none;">회원 탈퇴</a>
            </nav>
        </aside>

        <section>
            {{#member}}
                <form method="post" action="/member/edit" class="cg-form">
                    {{#_csrf}}<input type="hidden" name="{{parameterName}}" value="{{token}}">{{/_csrf}}

                    <!-- 기본 정보 -->
                    <div class="cg-card" style="margin-bottom:16px;">
                        <div class="cg-card__head"><h2>기본 정보</h2></div>
                        <div class="cg-card__body" style="padding:24px;">
                            <div style="display:flex;gap:24px;align-items:flex-start;">
                                <div style="flex:1;">
                                    <label for="member_nickname">닉네임</label>
                                    <input id="member_nickname" name="member_nickname" value="{{memberNickname}}" maxlength="8" required>

                                    <label for="member_age" style="margin-top:12px;">나이</label>
                                    <input id="member_age" name="member_age" type="number" value="{{memberAge}}">

                                    <label for="member_gender" style="margin-top:12px;">성별</label>
                                    <input id="member_gender" name="member_gender" maxlength="1" value="{{memberGender}}">

                                    <label for="member_photo" style="margin-top:12px;">프로필 사진 파일명</label>
                                    <!-- ★ value는 최상위 photoName 사용: memberPhoto 직접 참조 금지 -->
                                    <input id="member_photo" name="member_photo" value="{{photoName}}" placeholder="예: avatar01.png">
                                </div>

                                <div style="width:160px;text-align:center;">
                                    {{#hasPhoto}}
                                        <img src="{{photoUrl}}" alt="프로필" class="cg-avatar-lg"
                                             style="width:120px;height:120px;border-radius:9999px;object-fit:cover;display:block;margin:0 auto;">
                                        <div style="margin-top:8px;font-size:12px;color:#6b7280;">현재: {{photoName}}</div>
                                    {{/hasPhoto}}
                                    {{^hasPhoto}}
                                        <div class="cg-avatar-lg" style="width:120px;height:120px;border-radius:9999px;background:#e5e7eb;display:flex;align-items:center;justify-content:center;margin:0 auto;">
                                            <span style="font-size:12px;color:#6b7280;">NO IMG</span>
                                        </div>
                                        <div style="margin-top:8px;font-size:12px;color:#6b7280;">현재: 없음</div>
                                    {{/hasPhoto}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 비밀번호 변경(선택) -->
                    <div class="cg-card" style="margin-bottom:16px;">
                        <div class="cg-card__head"><h2>비밀번호 변경 (선택)</h2></div>
                        <div class="cg-card__body" style="padding:24px;">
                            <label for="current_password">현재 비밀번호</label>
                            <input id="current_password" name="current_password" type="password" autocomplete="current-password" placeholder="변경 시에만 입력">

                            <label for="new_password" style="margin-top:12px;">새 비밀번호</label>
                            <input id="new_password" name="new_password" type="password" autocomplete="new-password" placeholder="변경 시에만 입력">
                            <p style="margin-top:8px;font-size:12px;color:#6b7280;">* 현재/새 비밀번호를 모두 입력한 경우에만 비밀번호가 변경됩니다.</p>
                        </div>
                    </div>

                    <div style="display:flex;gap:8px;">
                        <button type="submit" class="cg-btn" style="padding:10px 16px;">저장</button>
                        <a href="/member/me" class="cg-btn" style="padding:10px 16px;border:1px solid #e5e7eb;text-decoration:none;">취소</a>
                    </div>
                </form>
            {{/member}}

            {{^member}}
                <div class="cg-card"><div class="cg-card__body" style="padding:24px;">사용자 정보를 불러오지 못했습니다.</div></div>
            {{/member}}
        </section>
    </div>
</main>

{{>layout/footer}}
